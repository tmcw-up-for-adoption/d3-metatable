<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
        <link rel='stylesheet' type='text/css' href='css/style.css' />
        <meta http-equiv='content-type' content='text/html; charset=utf-8' />
        <meta name='viewport' content='initial-scale=1.0 maximum-scale=1.0'>
        <style>
        .disabled {
            background:#eee;
        }
        body {
            max-width:960px;
            margin:20px auto;
        }
        </style>
    </head>
    <body>
        <h1>metatable</h1>
        <p>a table interface for heterogeneous JSON collections.</p>
        <textarea id='json'></textarea>
        <div id='table'>
        </div>
        <script src='js/d3.v3.min.js'></script>
        <script src='metatable.js'></script>
        <script>
        var data = [];
        for (var i = 0; i < 100; i++) {
            if (Math.random() > 0.9) {
                data.push({
                    v1: Math.random(),
                    v2: 'foo',
                    v3: 'foo bar' + Math.random()
                });
            } else if (Math.random() > 0.5) {
                data.push({
                    v2: 'foo',
                    v3: 'foo bar' + Math.random(),
                    v4: 'foo bar' + Math.random()
                });
            } else {
                data.push({
                    foo: 'foo'
                });
            }
        }
        d3.select('#json')
            .property('value', JSON.stringify(data, null, 2))
            .on('keyup', function() {
                data = JSON.parse(this.value);
                d3.select('#table').data([data]).call(metatable());
            });
            d3.select('#table').data([data]).call(metatable().on('change', function(d, i) {
                d3.select('#json')
                    .property('value', JSON.stringify(data, null, 2));
            }).on('rowfocus', function(d, i) {}));
        </script>
    </body>
</html>
